<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô - SwapABook</title>
    <link rel="stylesheet" href="/css/style.css" />
    <style>
      .history-container { max-width: 900px; margin: 30px auto; }
      .history-card { background: #fff; border-radius: 10px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.06); }
      .history-row { display:flex; gap:12px; align-items:center; }
      .history-thumb { width:48px; height:60px; object-fit:cover; border-radius:6px; }
      .history-meta h4 { margin:0; }
      .muted { color:#666; font-size:13px; }
    </style>
  </head>
  <body>
    <main class="container history-container">
      <h1>üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h1>
      <% if (typeof warning !== 'undefined' && warning) { %>
        <div style="background:#fff3cd;border:1px solid #ffe8a1;padding:12px;border-radius:8px;margin-bottom:12px;color:#8a6d00">‚ö†Ô∏è <%= warning %></div>
      <% } %>

      <% if (history && history.length > 0) { %>
        <% history.forEach(function(h) { %>
          <div class="history-card">
            <div class="history-row">
              <div style="flex:0 0 48px">
                <img src="<%= h.book1_thumbnail %>" class="history-thumb" alt="book1" onerror="this.src='/images/profile-placeholder.svg'" />
              </div>
              <div style="flex:0 0 48px">
                <img src="<%= h.book2_thumbnail %>" class="history-thumb" alt="book2" onerror="this.src='/images/profile-placeholder.svg'" />
              </div>
              <div style="flex:1" class="history-meta">
                <h4><%= h.book1_title || '‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠' %> ‚áÑ <%= h.book2_title || '‚Äî' %></h4>
                <div class="muted">‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á <strong><%= h.user1_username %></strong> ‡πÅ‡∏•‡∏∞ <strong><%= h.user2_username %></strong></div>
                <div class="muted">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <%= new Date(h.exchange_date).toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' }) %></div>
              </div>
            </div>
          </div>
        <% }); %>
      <% } else { %>
        <div style="padding:40px; text-align:center; color:#666">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</div>
      <% } %>
    </main>
  </body>
</html>