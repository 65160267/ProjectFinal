<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Swap A Book ‚Äî Dashboard</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <% 
      // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà controller ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏≤ (‡∏•‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Å‡∏¥‡∏î ReferenceError)
      if (typeof featured === 'undefined') featured = [];
      if (typeof recommendedA === 'undefined') recommendedA = [];
      if (typeof recommendedB === 'undefined') recommendedB = [];
      if (typeof books === 'undefined') books = [];
    %>
    <!-- Header -->
    <header class="site-header">
      <div class="header-inner container">
        <div class="brand">SwapABook</div>
        <form class="search" action="/" method="get">
          <input name="q" placeholder="Search for books" />
          <button type="submit">üîç</button>
        </form>
        <nav class="header-actions">
          <a href="/books" title="Cart">üõçÔ∏è</a>
          <a href="/auth/logout" title="Logout">üîì</a>
        </nav>
      </div>
    </header>

    <main class="container marketplace-main">
      <aside class="market-sidebar card">
        <h3>Marketplace</h3>
        <ul class="muted">
          <li>üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</li>
          <li>üìÑ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</li>
          <% if (typeof user !== 'undefined' && user && user.id) { %>
            <li><a href="/books/new" style="color:inherit;text-decoration:none">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</a></li>
          <% } %>
        </ul>
    
      </aside>

      <section class="market-content">
        
        <div class="card">
          <h2>Recently Posted</h2>
          <input class="search-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..." />
          <div class="product-grid">
            <% if (books && books.length) { %>
              <% books.forEach(function(b) { %>
                <div class="product-card">
                  <div class="product-thumb" data-thumb="<%= b.thumbnail || '/images/placeholder.png' %>"></div>
                  <div class="product-body">
                    <div class="product-title"><%= b.title || 'Product' %></div>
                    <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
                      <div class="product-tags">‡πÅ‡∏•‡∏Å‡∏Å‡∏±‡∏ö: <span class="badge"><%= b.tags || 'n/a' %></span></div>
                      <% if (b.condition) { %>
                        <div class="pill condition"><%= (b.condition === 'new' ? '‡πÉ‡∏´‡∏°‡πà' : (b.condition === 'good' ? '‡∏î‡∏µ' : '‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô')) %></div>
                      <% } %>
                    </div>
                    <div class="product-meta" style="margin-top:6px"><%= b.location || 'Unknown' %></div>
                  </div>
                </div>
              <% }); %>
            <% } else { %>
              <p class="muted empty-state">No products found.</p>
            <% } %>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer (minimal) -->
    <footer class="site-footer">
      <div class="container footer-bottom">
        <div class="copyright">Swap A Book <%= new Date().getFullYear() %> By Weerapat Tapaothong</div>
      </div>
    </footer>

    <script>
      // apply background images from data-thumb attributes
      document.querySelectorAll('.thumb[data-thumb], .small-thumb[data-thumb], .product-thumb[data-thumb]').forEach(el => {
        const url = el.getAttribute('data-thumb') || '/images/placeholder.png';
        el.style.backgroundImage = `url(${url})`;
      });
    </script>

    

  </body>
</html>
