<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>All Books</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <!-- Header -->
    <header class="site-header">
      <div class="header-inner container">
        <div class="brand">SwapABook</div>
        <form class="search" action="/" method="get">
          <input name="q" placeholder="Search for books" />
          <button type="submit">üîç</button>
        </form>
        <nav class="header-actions">
          <a href="/books" title="Cart">üõçÔ∏è</a>
          <% if (typeof user !== 'undefined' && user && user.username) { %>
            <a href="/user" class="header-user" title="Your profile">
              <img class="user-avatar" src="<%= user.avatar || '/images/profile-placeholder.png' %>" alt="Profile" />
            </a>
            <a href="/auth/logout" title="Logout">üîì</a>
          <% } else { %>
            <a href="/auth/login" title="Login">üîì</a>
          <% } %>
        </nav>
      </div>
    </header>

    <main class="container marketplace-main">
      <aside class="market-sidebar card">
        <h3>Marketplace</h3>
        <ul class="muted">
          <li><a href="/dashboard" style="color:inherit;text-decoration:none">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
          <li><a href="/books" style="color:inherit;text-decoration:none">üìÑ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a></li>
          <li><a href="/books/new" style="color:inherit;text-decoration:none">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</a></li>
        </ul>
      </aside>
      <section class="market-content">
        <div class="card">
          <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
          <div class="product-grid">
            <% if (books && books.length) { %>
              <% books.forEach(function(b) { %>
                <div class="product-card">
                  <div class="product-thumb" data-thumb="<%= b.thumbnail || '/images/placeholder.png' %>"></div>
                  <div class="product-body">
                    <div class="product-title"><a href="/books/<%= b.id %>"><%= b.title %></a></div>
                    <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
                      <div class="product-tags">‡πÅ‡∏•‡∏Å‡∏Å‡∏±‡∏ö: <span class="badge"><%= b.tags || 'n/a' %></span></div>
                      <% if (b.condition) { %>
                        <div class="pill condition"><%= (b.condition === 'new' ? '‡πÉ‡∏´‡∏°‡πà' : (b.condition === 'good' ? '‡∏î‡∏µ' : '‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô')) %></div>
                      <% } %>
                    </div>
                    <div class="product-meta" style="margin-top:6px"><%= b.location || 'Unknown' %></div>
                    <div style="margin-top:10px"><a class="btn btn-ghost" href="/books/<%= b.id %>">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</a></div>
                  </div>
                </div>
              <% }); %>
            <% } else { %>
              <p class="muted empty-state">No books found.</p>
            <% } %>
          </div>
        </div>
      </section>
    </main>

    <script>
      document.querySelectorAll('.product-thumb[data-thumb]').forEach(el => {
        const url = el.getAttribute('data-thumb') || '/images/placeholder.png';
        el.style.backgroundImage = `url(${url})`;
      });
    </script>
    <!-- Footer (minimal) -->
    <footer class="site-footer">
      <div class="container footer-bottom">
        <div class="copyright">Swap A Book <%= new Date().getFullYear() %> By Weerapat Tapaothong</div>
      </div>
    </footer>
  </body>
</html>
